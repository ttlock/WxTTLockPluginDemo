# 通通锁蓝牙模块通信插件接口常见问题

###### 1. 10030, 启动蓝牙适配器失败
  请检查蓝牙是否已正确启动且相关权限已开启
  1. 安卓需开启系统蓝牙及位置权限、开启微信位置权限授权并授予小程序scope.bluetooth权限
  2. iOS需开启系统蓝牙、开启微信蓝牙授权并授予小程序scope.bluetooth权限
  3. 2.7.0及其之后版本，操作过程中关闭蓝牙或取消授权可能跳过权限检验而返回该错误

###### 2. 真机调试模式下设备连接已断开或无法正常操作
  真机调试模式下，移动设备与后台调试输出进行数据交互会耗费大量时间从而导致设备长时间无响应而断开连接，固请勿使用真机调试模式进行操作
  （例：预览模式蓝牙单个接口耗时4ms, 相同操作真机调试输出约耗时1004ms）
  1. 使用开发者工具中【预览】模式，扫描后打开小程序设置【...】-> 【开发调试】进行设备调试

###### 3. 10007, 10032, 10034等由于设备断连引起的问题
  设备无法连接或意外断开连接
  1. 2.7.0版本开始在接口调用完成后不再强行断开连接，可调用stopAllOperations接口，断开所有蓝牙操作后重新操作

###### 4. 11013, 蓝牙正在操作中，请稍候再试
  设备正在操作中，不能进行其它接口调用
  1. 等待其它接口调用完成并返回后再次调用
  2. 调用stopAllOperations接口，强行断开所有蓝牙操作后重新操作

###### 5. 10036, 搜索不到设备，已停止搜索，请确认是否在锁附近或稍后重试
  设备不在扫描范围内，无法进行连接
  1. 需要在设备旁边操作
  2. 确认设备在附近后，调用stopAllOperations接口，强行断开所有蓝牙操作并重启蓝牙，重新操作
  3. iOS设备ID转换失败，断开所有连接后操作重试或传入正确的deviceId以跳过相关步骤

###### 6. 10038, 微信基础库版本过低，请升级
  当前微信基础库版本需在2.14.1版本及其以上，插件中校验2.9.5版本及其以上

###### 7. iOS开锁过程慢
  iOS设备ID和安卓设备ID不匹配，在程序中会进行转换
  1. 2.7.0版本开始支持传入deviceId，在进行一次蓝牙操作成功后会在返回参数中返回deviceId, 第二次调用时可将该参数传入以跳过设备转换
  2. 安卓设备不进行设备转换，deviceId不必传入
  3. 参考第9条

###### 8. 返回错误码19
  WIFI不可设置或设备未进入可配置WIFI状态
  1. 调用扫描WIFI接口后，在返回列表中选择参数重新调用
  设备不支持相关操作，如：设备不支持本地IP地址配置

###### 9. 设备开锁耗时过长
  接口中设置三次设备连接重试，单次超时10s，如设备超时连接不上，则可能导致设备连接耗时过长（一般超过10s）
  1. 可自行调用微信相关接口并连接设备后再调用插件提供的接口(可缩减接口操作时间，但实际开锁总时间无法优化)
  2. 摸亮智能锁后进行设备操作
  iOS设备ID非MAC值，需进行设备ID转换
  1. 传入deviceId以跳过设备ID转换步骤（可优化2-3s）

###### 10. 返回-1、-2、-3错误码
  1. 重新调用接口操作即可

###### 11. 10003错误码
  1. 操作过程中设备断开连接，重新调用接口
  2. 真机调试模式下，移动设备与后台调试输出进行数据交互会耗费大量时间从而导致设备长时间无响应

###### 12. 设备在附近但返回10002（设备连接失败，请确认设备是否在附近）
  设备连接超时，无法连接
  1. 重新调用接口
  2. 摸亮智能锁后，重新操作相关接口
  移动设备蓝牙出现问题
  1. 重启设备蓝牙后重新操作(由于微信状态更新有延迟，可能无法及时检测到蓝牙重新开启，可删除小程序后重新添加或等待微信蓝牙检测状态更新后重新操作（重复操作）)
  智能设备已被重置且未被重新添加，在未摸亮锁时无法进行设备连接
  1. 重新添加智能设备后操作

###### 13. 智能锁未被重置但返回锁可能被重置提示
  接口调用时传入deviceId，但deviceId对应的设备与lockData或deviceScanFromDevice所对应的设备不匹配
  1. 传入正确的deviceId或不传入deviceId